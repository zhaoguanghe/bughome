<!DOCTYPE html>
<!--
Copyright (c) 2003-2019, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
-->
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link type="text/css" href="asserts/css/sample.css" rel="stylesheet" media="screen" />
    <link rel="stylesheet" href="asserts/layui/css/layui.css" />
    <link rel="stylesheet" href="asserts/css/global.css" />
    <script type="text/javascript" src="asserts/js/jquery.min.js" ></script>
    <title>editor</title>
</head>
<body>
<div th:insert="~{header :: copy}"></div>
<input id="Title" type="text" placeholder="请输入文章名"/>
<input id="Abstract" type="text" placeholder="请输入文章简介"/>
<input id="Author" type="text" placeholder="请输入作者"/>
<main>
    <div class="message">
        <div class="centered">
            <h1>Congratulations!</h1>

            <p>If you can see CKEditor below, it means that the installation succeeded. You can now try out your new editor version, see its features,
                and check some of the most useful <a href="#references">resources recommended below</a>.</p>
        </div>
    </div>
    <div class="centered">
        <div id="editor">
            <h2>The three greatest things you learn from traveling</h2>

            <p>Like all the great things on earth traveling teaches us by example. Here are some of the most precious lessons I’ve learned over the years of traveling.</p>

            <h3>Appreciation of diversity</h3>

            <p>Getting used to an entirely different culture can be challenging. While it’s also nice to learn about cultures online or from books, nothing comes close to experiencing <a href="https://en.wikipedia.org/wiki/Cultural_diversity">cultural diversity</a> in person. You learn to appreciate each and every single one of the differences while you become more culturally fluid.</p>

            <figure class="image image-style-side"><img src="asserts/img/umbrellas.jpg" alt="Three Monks walking on ancient temple.">
                <figcaption>Leaving your comfort zone might lead you to such beautiful sceneries like this one.</figcaption>
            </figure>

            <h3>Confidence</h3>

            <p>Going to a new place can be quite terrifying. While change and uncertainty makes us scared, traveling teaches us how ridiculous it is to be afraid of something before it happens. The moment you face your fear and see there was nothing to be afraid of, is the moment you discover bliss.</p>
        </div>
    </div>
</main>
<div class="fly-column-left">
    <a id="submit" class="layui-btn" onclick="Submit()">提交</a>
</div>
<div th:insert="~{footer :: copy}"></div>
<script src="asserts/js/ckeditor.js"></script>

<script>
    var i = 0;
    ClassicEditor
        .create( document.querySelector( '#editor' ), {
            toolbar: [ 'heading', '|', 'bold', 'italic', 'link' ]
        } )
        .then( editor => {
        window.editor = editor;
        var btn = document.querySelector('#submit')
        btn.onclick = () => {
        var content = editor.getData();
        //console.log(content);
        var Title = $('#Title').val();
        var Abstract = $('#Abstract').val();
        var Author = $('#Author').val();
        if (i < 1) {
            if (Title != "" && Abstract != "" && Author != "") {
                console.log(content + Abstract + Title + Author);
                $.post("http://localhost:8081/addArticle",
                    {
                        Author: "清风思月",
                        Abstract: "暂无",
                        Title: "文章",
                        Content: content
                    },
                    function (data) {
                        console.log(data);
                        if (data > 0 && data < 99999) {//返回id
                            alert('提交成功');
                            i += 1;
                            window.location.href = "http://localhost:8081/detail?id=" + data;
                        } else {
                            alert('提交失败');
                            console.log(data);
                        }
                    });
            } else {
                alert("请填写完整！");
            }
        } else {
            alert("请勿重复提交！");
        }
    }
    })
    .catch( err => {
        console.error( err.stack );
    });
    /*
    function Submit() {
        var oEditor = CKEDITOR.instances.content;
        var Content = oEditor.getData();
        alert(Content);
        var Title = $('#Title').val();
        var Abstract = $('#Abstract').val();
        var Author = $('#Author').val();
        if (i < 1) {
            if (Title != "" && Abstract != "" && Author != "") {
                alert(Content + Abstract + Content + Author);
                $.post("http://localhost:8081/addArticle",
                    {
                        Author: Author,
                        Abstract: Abstract,
                        Title: Title,
                        Content: Content
                    },
                    function (data) {
                        console.log(data);
                        if (data > 0 && data < 99999) {//返回id
                            alert('提交成功');
                            i += 1;
                            window.location.href = "http://localhost:8081/detail?id=" + data;
                        } else {
                            alert('提交失败');
                            console.log(data);
                        }
                    });
            } else {
                alert("请填写完整！");
            }
        } else {
            alert("请勿重复提交！");
        }
    }*/
</script>
</body>
</html>